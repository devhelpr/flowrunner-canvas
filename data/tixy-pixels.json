[{"id":"Tixypixels","x":181.55247135240853,"y":1097.0859758277838,"shapeType":"Rect","name":"Tixypixels","taskType":"DebugTask","htmlPlugin":"debugNode","visualizer":"animatedgridcanvas","propertyName":"","format":"toFixed","fixed":2,"decimalSeparator":",","afterLabel":"","flowId":"1219010f-cc09-406c-b952-435274ec8faa","columns":16,"rows":16,"mode":"pixels","width":512,"height":512},{"id":"ScriptTask","x":-1095.1406932379043,"y":1282.8706631892965,"shapeType":"Rect","name":"ScriptTask","taskType":"ScriptTask","width":600,"rows":10,"outputProperty":"script","script":"function_i32 getaddress(xx,yy) {\n  return_i32 yy*1024+xx*4;\n}\nfunction distance(xx,yy,xa,ya) {\n  return sqrt((xx-xa)*(xx-xa) + (yy-ya)*(yy-ya));\n}\nfunction_i32 setpixel(address,value) {\n  store(address,value,0,0);\n  return_i32 0;\n}\nfunction hypot(a,b) { \n    return sqrt(a*a+b*b);\n}\n/*\nfunction helper(v) {\n\t\tMath.hypot(\n\t\t\tx-7+Math.sin((t/500)*9/v)*6,\n\t     \ty-7+Math.cos((t/500)*7/v)*4\n\t\t);\n\t}\n\treturn 2-helper(5)*helper(8)/6\n\n*/\nlet_i32 loopx = 0;\nlet_i32 loopy = 0;\nlet_i32 address = 0;\nlet help = 0;\nlet_i32 help2 = 0;\nlet xf = 0;\nlet yf = 0;\n\nlet cx = 0;\nlet cy = 0;\nlet cx2 = 0;\nlet cy2 = 0;\n\nlet tf = 0;\nlet tf2 = 0;\nlet tf3 = 0;\nlet tf4 = 0;\ncx = 128.0+128.0*sin(time/3000);\ncy = 128.0+128.0*sin(0.7+time/5000);\n\ntf =  sin(time/20000) *0.0065;\ntf2 = (0.5*sin(time/3000))+8;\n\ncx2 = 128.0+128.0*sin(time/1000);\ncy2 = 128.0+128.0*sin(0.7+time/2000);\n\ntf3  =  sin(time/2000) *0.0065;\ntf4 = (0.25*sin(time/2000))+10;\n\nwhile_i32 (loopy<256) {\n  loopx = 0;\n  while_i32 (loopx < 256) {\n    address = getaddress(loopx,loopy);\n    \n    yf = convert_signed_i32_to_f32(loopy);\n    xf = convert_signed_i32_to_f32(loopx);\n\n    help = 128+(sin(\n     sin(distance(xf,yf,cx,cy) * tf) * tf2) * 0.5+\n  sin(\n     sin(distance(xf,yf,cx2,cy2) * tf3) * tf4) * 0.5) \n       * 128;\n\n    setpixel(address, trunc_signed_f32_to_i32(help));\n    loopx = loopx + 1;\n  }\n  loopy = loopy + 1;\n}\nreturn 0;","htmlPlugin":"formNode"},{"id":"ScriptTask1","x":-410.88604824461214,"y":936.6023490923708,"shapeType":"Rect","name":"ScriptTask1","taskType":"ScriptTask","outputProperty":"script","rows":10,"script":"// TODO : implement range-map function to\n//   be able to map loopx 0..383 to 0..255\n//   because of max color component\n// TODO : changing width/height should \n//    force recompile because of memory\n\ninput slider;\ninput slider2;\ninput colorfactor;\ninput range;\ninput colorfade;\n\nfunction_i32 mapvalue(min,max,valuerangemin, valuerangemax,value) {\n   let_i32 maxmin = 0;\n   maxmin = max-min;\t \n   let_i32 valuemaxmin = 0;\n   valuemaxmin = valuerangemax- \n   valuerangemin;\n   let multiplier = 0;\n   multiplier = (\n      convert_signed_i32_to_f32(maxmin)\n\t)/(\n\t\tconvert_signed_i32_to_f32(valuemaxmin)\n\t);\n\t/*\n\t\t0..255 0..383\n\t*/\n\tlet result = 0;\n         result = \n          convert_signed_i32_to_f32(value) \n          * multiplier;\n\treturn trunc_signed_f32_to_i32(result);\n}\n\nfunction_i32 getaddress(xx,yy,maxwidth) {\n  return_i32 yy*maxwidth*4+xx*4;\n}\nfunction distance(xx,yy,xa,ya) {\n  return sqrt(\n   (xx-xa)*(xx-xa) + \n   (yy-ya)*(yy-ya)\n  );\n}\nfunction_i32 \n  setpixel(address,value,valuex,valuey) {\n    store(address,value,valuex,valuey);\n    return_i32 0;\n}\n\nfunction_i32 \n  setpixelcolor(address,value) {\n    storeHex(address,value);\n    return_i32 0;\n}\n\nfunction hypot(a,b) { \n  return sqrt(a*a+b*b);\n}\nfunction helper(xt,yt,sc,cc) {\n   return hypot(xt-sc,yt-cc)*0.25;\n}\nlet_i32 loopx = 0;\nlet_i32 loopy = 0;\nlet_i32 address = 0;\n\nlet help = 0;\n\nlet xf = 0;\nlet yf = 0;\n\nlet tf = 0;\nlet tf2 = 0;\nlet tf3 = 0;\nlet tf4 = 0;\nlet tf5 = 0;\nlet tf6 = 0;\n\nlet sliderhelper = 0;\nsliderhelper = slider * 2.0;\n\nlet sliderhelper2 = 0;\nsliderhelper2 = slider2 * 2.0;\n\ntf = (width/2)+\n    sin((time/500)*2)*sliderhelper;\ntf3 = (height/2)+\n   sin(0.7+(time/500)*1.2)*sliderhelper;\n\ntf2 = (width/2)+\n     sin((time/750)*0.8)*sliderhelper2;\ntf4 = (height/2)+\n     sin(0.7+(time/750)*1.6)*sliderhelper2;\n\ntf5 = (width/2)+\n     sin(0.35+(time/750)*1.5)*sliderhelper2;\ntf6 = (height/2)+\n     sin(1.05+(time/750)*1.8)*sliderhelper2;\n\nlet colorfactorhelper = 0;\ncolorfactorhelper = colorfactor * 2.55;\n\nlet rangehelper = 0;\nrangehelper = range * 2.55;\n\nlet_i32 maxloopheight = 0;\nlet_i32 maxloopwidth = 0;\nmaxloopheight= trunc_signed_f32_to_i32(height);\nmaxloopwidth= trunc_signed_f32_to_i32(width);\n\nwhile_i32 (loopy<maxloopheight) {\n  loopx = 0;\n  while_i32 (loopx < maxloopwidth) {\n    address = getaddress(loopx,loopy,maxloopwidth);\n    \n    yf = convert_signed_i32_to_f32(loopy);\n    xf = convert_signed_i32_to_f32(loopx);\n\n    help = 256-\n       helper(xf,yf,tf,tf3)*\n       helper(xf,yf,tf2,tf4)*\n       helper(xf,yf,tf5,tf6)\n       /128;\n\n    if (help < 0) {\n      help = 0;\n    }\n    if (help > 255) {\n      help = 255;\n    }\n    if (help > (255-rangehelper)) {\n      setpixel(\n        address, \n        trunc_signed_f32_to_i32(help),\n      trunc_signed_f32_to_i32(colorfactorhelper),\n        0\n      ); \n    } else {\n// send this as i64?\n// format is bgr\n//setpixelcolor(address, 0xff0000);\n      setpixel(\n        address, \n        0,\n        mapvalue(0,255,0,maxloopheight,\n          loopy),\n        mapvalue(0,255,0,maxloopwidth,\n          loopx)\n      );\n       \n    }\n\n    loopx = loopx + 1;\n  }\n  loopy = loopy + 1;\n}\nreturn 0;","width":500,"htmlPlugin":"formNode"},{"name":"connection-dc34d180-5099-4b15-a225-6b7daf2461f5","taskType":"connection","shapeType":"Line","startshapeid":"ScriptTask1","endshapeid":"Tixypixels","xstart":-160.88604824461214,"ystart":878.6023490923708,"xend":-92.44752864759147,"yend":885.0859758277838,"thumbPosition":0},{"id":"FormTask","x":-1179.2360107696884,"y":812.8305828548058,"shapeType":"Rect","name":"FormTask","taskType":"FormTask","metaInfo":[{"fieldType":"slider","fieldName":"slider"},{"fieldName":"slider2","fieldType":"slider"},{"fieldName":"colorfactor","fieldType":"slider"},{"fieldName":"range","fieldType":"slider"},{"fieldName":"colorfade","fieldType":"slider"}]},{"name":"connection-d1ed879b-3e89-48c3-8487-e17c935cdc67","taskType":"connection","shapeType":"Line","startshapeid":"FormTask","endshapeid":"ScriptTask1","xstart":-1029.2360107696884,"ystart":625.8305828548058,"xend":-668.8860482446121,"yend":878.6023490923708,"thumbPosition":0}]